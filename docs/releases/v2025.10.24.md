# v2025.10.24 - PackMind config wiring and safety/stability improvements
> Author: 7Lynx · Doc Version: 2025.10.24

Release tag: `v2025.10.24`

## Highlights
- PackMind runtime now respects key configuration toggles and thresholds for sound attention, voice runtime, sensor backoff, stuck detection, and safety watchdog.
- Scanning cadence and energy system are parameterized from config; face recognition camera settings and max faces corrected.
- Focus on making PackMind tunable without code edits and improving safety behavior on timeouts.

## Changes
### Changed
- Sound attention is now fully config-driven in `packmind/orchestrator.py`:
  - `SOUND_HEAD_SENSITIVITY` scales head yaw response to sound direction
  - `SOUND_BODY_TURN_THRESHOLD` controls when to add a body turn
  - `SOUND_RESPONSE_ENERGY_MIN` gates body turn by energy level
  - Speech volumes now mapped via `VOICE_VOLUME_DEFAULT`, `VOICE_VOLUME_EXCITED`, `VOICE_VOLUME_QUIET`
- Voice runtime configuration wired through `packmind/runtime/voice_runtime.py` and orchestrator:
  - `VOICE_MIC_INDEX`, `VOICE_WAKE_TIMEOUT_S`, `VOICE_VAD_SENSITIVITY`, `VOICE_LANGUAGE`, `VOICE_NOISE_SUPPRESSION`, `VOICE_COMMAND_TIMEOUT`
  - Applied to `speech_recognition` microphone device, timeouts, energy/VAD, language, and ambient calibration
- Sensor monitor gains error backoff in `packmind/runtime/sensor_monitor.py` and is configured from `SENSOR_MONITOR_BACKOFF_ON_ERROR_S`.
- Stuck detection thresholds moved to config in `packmind/services/obstacle_service.py`:
  - `STUCK_TIME_WINDOW`, `STUCK_MOVEMENT_THRESHOLD`, `STUCK_AVOIDANCE_LIMIT`
- Safety watchdog integration strengthened in `packmind/orchestrator.py`:
  - Heartbeat paced by `WATCHDOG_HEARTBEAT_INTERVAL_S`
  - Timeout triggers `emergency_stop`; optional `WATCHDOG_ACTION="power_down"` attempts power down if supported
- Scanning and energy system parameterization:
  - Scanning: `HEAD_SCAN_SPEED`, `HEAD_SCAN_RANGE`, `SCAN_SAMPLES`, `SCAN_DEBOUNCE_S`
  - Energy: `ENERGY_DECAY_RATE`, `ENERGY_INTERACTION_BOOST`, `ENERGY_REST_RECOVERY`, thresholded speeds via `ENERGY_HIGH_THRESHOLD` and `ENERGY_LOW_THRESHOLD`
- Face recognition adjustments:
  - Fixed config key to `FACE_MAX_FACES_PER_FRAME`; camera uses `FACE_CAMERA_WIDTH`, `FACE_CAMERA_HEIGHT`, `FACE_CAMERA_FPS`

### Notes
- These changes aim to make PackMind behavior tuneable via `packmind/packmind_config.py` across a variety of environments.
- Reasonable defaults are provided; fine-tune values to match your mic, room acoustics, and preferred responsiveness.

## Upgrade notes
- Review and adjust these config keys as needed in `packmind/packmind_config.py`:
  - SOUND_* (sensitivity/threshold/energy gate)
  - VOICE_* (mic index, timeouts, language, VAD)
  - SENSOR_MONITOR_BACKOFF_ON_ERROR_S
  - STUCK_* thresholds
  - WATCHDOG_* heartbeat/action
  - Scanning and energy families if you haven’t already

## Tag summary
- Config-driven: sound attention, voice runtime, sensor backoff, stuck detection, watchdog actions
- Parameterized scanning and energy behavior from config
- Face recognition config fixes; camera settings from config
- Focused on safety, tunability, and stability
